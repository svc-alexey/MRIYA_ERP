
#Область ПрограммныйИнтерфейс

#Область РаботаСПараметрамиСеанса

// Получает логин Диадок из параметров сеанса
//
// Возвращаемое значение:
//   Строка - Логин пользователя Диадок или пустая строка, если параметр не заполнен
//
Функция ПолучитьЛогинДиадок() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Попытка
		
		Результат = ПараметрыСеанса.ЛогинДиадок;
		
	Исключение
		
		Результат = "";
		
	КонецПопытки;
	
	УстановитьПривилегированныйРежим(Ложь);
	
	Возврат Результат;
	
КонецФункции

// Получает пароль Диадок из параметров сеанса
//
// Возвращаемое значение:
//   Строка - Пароль пользователя Диадок или пустая строка, если параметр не заполнен
//
Функция ПолучитьПарольДиадок() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Попытка
		
		Результат = ПараметрыСеанса.ПарольДиадок;
		
	Исключение
		
		Результат = "";
		
	КонецПопытки;
	
	УстановитьПривилегированныйРежим(Ложь);
	
	Возврат Результат;
	
КонецФункции

// Получает ключ разработчика Диадок из параметров сеанса
//
// Возвращаемое значение:
//   Строка - Ключ API Диадок или пустая строка, если параметр не заполнен
//
Функция ПолучитьКлючРазработчикаДиадок() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Попытка
		
		Результат = ПараметрыСеанса.КлючРазработчикаДиадок;
		
		// Если параметр сеанса не заполнен, используем ключ по умолчанию
		Если НЕ ЗначениеЗаполнено(Результат) Тогда
			Результат = ПолучитьКлючРазработчикаПоУмолчанию();
		КонецЕсли;
		
	Исключение
		
		Результат = ПолучитьКлючРазработчикаПоУмолчанию();
		
	КонецПопытки;
	
	УстановитьПривилегированныйРежим(Ложь);
	
	Возврат Результат;
	
КонецФункции

// Устанавливает значение параметра сеанса
//
// Параметры:
//   ИмяПараметра - Строка - Имя параметра сеанса
//   Значение - Произвольный - Устанавливаемое значение
//
Процедура УстановитьПараметрСеанса(Знач ИмяПараметра, Значение) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	ПараметрыСеанса[ИмяПараметра] = Значение;
	
	УстановитьПривилегированныйРежим(Ложь);
	
КонецПроцедуры

#КонецОбласти

#Область РаботаСДиадокAPI

// Проверяет данные аутентификации пользователя Диадок
//
// Параметры:
//   ЛогинНаСайтДиадок - Строка - Логин пользователя Диадок
//   ПарольНаСайтДиадок - Строка - Пароль пользователя Диадок
//
// Возвращаемое значение:
//   Структура - Структура с ключами:
//     * Успех - Булево - Признак успешной аутентификации
//     * ТекстОшибки - Строка - Текст ошибки, если аутентификация не удалась
//
Функция ПроверитьДанныеАвторизации(ЛогинНаСайтДиадок, ПарольНаСайтДиадок) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("Успех", Ложь);
	Результат.Вставить("ТекстОшибки", "");
	
	Если НЕ ЗначениеЗаполнено(ЛогинНаСайтДиадок) Тогда
		Результат.ТекстОшибки = "Не заполнен логин";
		Возврат Результат;
	КонецЕсли;
	
	Если НЕ ЗначениеЗаполнено(ПарольНаСайтДиадок) Тогда
		Результат.ТекстОшибки = "Не заполнен пароль";
		Возврат Результат;
	КонецЕсли;
	
	КлючРазработчика = ПолучитьКлючРазработчикаДиадок();
	
	Попытка
		
		АдресРесурса = "/Authenticate?login=" + ЛогинНаСайтДиадок + "&password=" + ПарольНаСайтДиадок;
		АдресСайта = "diadoc-api.kontur.ru";
		
		HTTPЗапрос = Новый HTTPЗапрос;
		HTTPЗапрос.Заголовки.Вставить("POST " + АдресРесурса + " HTTP/1.1");
		HTTPЗапрос.Заголовки.Вставить("Host", АдресСайта);
		HTTPЗапрос.Заголовки.Вставить("Content-Length", 0);
		HTTPЗапрос.Заголовки.Вставить("Authorization", "DiadocAuth ddauth_api_client_id=" + КлючРазработчика);
		HTTPЗапрос.АдресРесурса = АдресРесурса;
		
		Соединение = Новый HTTPСоединение(АдресСайта, , , , , 60, Новый ЗащищенноеСоединениеOpenSSL(), Ложь);
		ФайлРезультата = ПолучитьИмяВременногоФайла();
		
		Попытка
			
			Соединение.ОтправитьДляОбработки(HTTPЗапрос, ФайлРезультата);
			
			Ответ = Новый ТекстовыйДокумент();
			Ответ.Прочитать(ФайлРезультата, КодировкаТекста.UTF8);
			ТекстОтвета = Ответ.ПолучитьТекст();
			
		Исключение
			
			УдалитьФайлы(ФайлРезультата);
			ВызватьИсключение;
			
		КонецПопытки;
		
		УдалитьФайлы(ФайлРезультата);
		
		// Проверяем ответ на наличие ошибок
		Если Найти(ТекстОтвета, "Wrong") > 0 Тогда
			Результат.ТекстОшибки = "Неверный логин или пароль";
			Возврат Результат;
		КонецЕсли;
		
		// Если дошли сюда - аутентификация успешна
		Результат.Успех = Истина;
		
	Исключение
		
		Результат.ТекстОшибки = "Ошибка подключения к Диадок: " + ОписаниеОшибки();
		
	КонецПопытки;
	
	Возврат Результат;
	
КонецФункции

// Получает структуру документа через API Диадок
//
// Параметры:
//   ЛогинНаСайтДиадок - Строка - Логин пользователя Диадок
//   ПарольНаСайтДиадок - Строка - Пароль пользователя Диадок
//   КлючРазработчика - Строка - Ключ API разработчика
//   Документ - ДокументСсылка - Ссылка на документ
//
// Возвращаемое значение:
//   Строка - Статус документа или пустая строка в случае ошибки
//
Функция ПолучитьСтруктуруДокументаПоAPIДиадок(ЛогинНаСайтДиадок, ПарольНаСайтДиадок, КлючРазработчика, Документ) Экспорт
	
	Если НЕ ЗначениеЗаполнено(Документ) Тогда
		Возврат "";
	КонецЕсли;
	
	ТекстТЗ = "";
	
	Попытка
		
		АдресРесурса = "/Authenticate?login=" + ЛогинНаСайтДиадок + "&password=" + ПарольНаСайтДиадок;
		АдресСайта = "diadoc-api.kontur.ru";
		HTTPЗапрос2 = Новый HTTPЗапрос;
		HTTPЗапрос2.Заголовки.Вставить("POST " + АдресРесурса + " HTTP/1.1");
		HTTPЗапрос2.Заголовки.Вставить("Host", "diadoc-api.kontur.ru");
		HTTPЗапрос2.Заголовки.Вставить("Content-Length", 0);
		HTTPЗапрос2.Заголовки.Вставить("Authorization", "DiadocAuth ddauth_api_client_id=" + КлючРазработчика);
		HTTPЗапрос2.АдресРесурса = АдресРесурса;
		Соединение1 = Новый HTTPСоединение(АдресСайта, , , , , 60, Новый ЗащищенноеСоединениеOpenSSL(), Ложь);
		ФайлРезультата = ПолучитьИмяВременногоФайла();
		
		Попытка
			Соединение1.ОтправитьДляОбработки(HTTPЗапрос2, ФайлРезультата);
			Ответ = Новый ТекстовыйДокумент();
			Ответ.Прочитать(ФайлРезультата, КодировкаТекста.UTF8);
			ПолеДокумента1 = Ответ.ПолучитьТекст();
		Исключение
			УдалитьФайлы(ФайлРезультата);
			ВызватьИсключение;
		КонецПопытки;
		
		УдалитьФайлы(ФайлРезультата);
		
		boxId = ПолучитьИдентификаторЯщикаДокумента(Документ);
		Гуид = ПолучитьИдентификаторДокумента(Документ);
		messageId = Лев(Гуид, 36);
		entityId = СтрЗаменить(Гуид, messageId, "");
		
		АдресСайта = "diadoc-api.kontur.ru/V3/GetDocument?boxId=" + boxId + "&messageId=" + messageId + "&entityId=" + entityId;
		HTTPЗапрос2 = Новый HTTPЗапрос;
		HTTPЗапрос2.Заголовки.Вставить("GET /V3/GetDocument HTTP/1.1");
		HTTPЗапрос2.Заголовки.Вставить("Host", "diadoc-api.kontur.ru");
		HTTPЗапрос2.Заголовки.Вставить("Accept", "application/json");
		HTTPЗапрос2.Заголовки.Вставить("Content-Type", "application/json; charset=utf-8");
		HTTPЗапрос2.Заголовки.Вставить("Authorization", "DiadocAuth ddauth_api_client_id=" + КлючРазработчика + ",ddauth_token=" + ПолеДокумента1);
		Соединение1 = Новый HTTPСоединение(АдресСайта, , , , , 60, Новый ЗащищенноеСоединениеOpenSSL(), Ложь);
		ОтветHTTP = Соединение1.Получить(HTTPЗапрос2);
		ТекстТЗ = ОтветHTTP.ПолучитьТелоКакСтроку();
		
	Исключение
		Возврат "";
	КонецПопытки;
	
	Если НЕ ЗначениеЗаполнено(ТекстТЗ) Тогда
		Возврат "";
	КонецЕсли;
	
	Попытка
		
		Статусы = ПолучитьСоответствиеСтатусовДокументов();
		
		СтруктураJson1 = ПрочитатьДанныеJSON(ТекстТЗ);
		
		Попытка
			Статус_ = Статусы.Получить(СтруктураJson1.RecipientReceiptMetadata.ReceiptStatus);
		Исключение
			Статус_ = "";
		КонецПопытки;
		
		Если Статус_ = Неопределено Тогда
			Статус_ = "";
		КонецЕсли;
		
		Попытка
			Статус = СтруктураJson1.DocflowStatus.PrimaryStatus.StatusText;
		Исключение
			Статус = "";
		КонецПопытки;
		
		Возврат Статус_ + ?(ЗначениеЗаполнено(Статус_), ", ", "") + Статус;
		
	Исключение
		Возврат ТекстТЗ;
	КонецПопытки;
	
КонецФункции

// Получает ссылку на документ в веб-интерфейсе Диадок
//
// Параметры:
//   ЛогинНаСайтДиадок - Строка - Логин пользователя Диадок
//   ПарольНаСайтДиадок - Строка - Пароль пользователя Диадок
//   КлючРазработчика - Строка - Ключ API разработчика
//   Документ - ДокументСсылка - Ссылка на документ
//
// Возвращаемое значение:
//   Строка - URL документа в Диадок или пустая строка в случае ошибки
//
Функция ПолучитьСсылкуНаДокументДиадок(ЛогинНаСайтДиадок, ПарольНаСайтДиадок, КлючРазработчика, Документ) Экспорт
	
	Если НЕ ЗначениеЗаполнено(Документ) Тогда
		Возврат "";
	КонецЕсли;
	
	Попытка
		
		АдресРесурса = "/Authenticate?login=" + ЛогинНаСайтДиадок + "&password=" + ПарольНаСайтДиадок;
		АдресСайта = "diadoc-api.kontur.ru";
		HTTPЗапрос2 = Новый HTTPЗапрос;
		HTTPЗапрос2.Заголовки.Вставить("POST " + АдресРесурса + " HTTP/1.1");
		HTTPЗапрос2.Заголовки.Вставить("Host", "diadoc-api.kontur.ru");
		HTTPЗапрос2.Заголовки.Вставить("Content-Length", 0);
		HTTPЗапрос2.Заголовки.Вставить("Authorization", "DiadocAuth ddauth_api_client_id=" + КлючРазработчика);
		HTTPЗапрос2.АдресРесурса = АдресРесурса;
		Соединение1 = Новый HTTPСоединение(АдресСайта, , , , , 60, Новый ЗащищенноеСоединениеOpenSSL(), Ложь);
		ФайлРезультата = ПолучитьИмяВременногоФайла();
		
		Попытка
			Соединение1.ОтправитьДляОбработки(HTTPЗапрос2, ФайлРезультата);
			Ответ = Новый ТекстовыйДокумент();
			Ответ.Прочитать(ФайлРезультата, КодировкаТекста.UTF8);
		Исключение
			УдалитьФайлы(ФайлРезультата);
			ВызватьИсключение;
		КонецПопытки;
		
		УдалитьФайлы(ФайлРезультата);
		
		boxId = ПолучитьИдентификаторЯщикаДокумента(Документ);
		Гуид_ДляСсылки = ПолучитьИдентификаторДокументаДляСсылки(Документ);
		
		Результат = Новый Структура;
		Результат.Вставить("LetterID", Лев(Гуид_ДляСсылки, 36));
		Результат.Вставить("DocumentID", Прав(Гуид_ДляСсылки, 36));
		
		Возврат MRS_ИнтеграцияДиадокКлиентСервер.СформироватьСсылкуВБраузере(
			MRS_ИнтеграцияДиадокКлиентСервер.АдресЯщикаВИдентификатор(boxId), Результат.LetterID, Результат.DocumentID);
		
	Исключение
		Возврат "";
	КонецПопытки;
	
КонецФункции

// Сохраняет статус документа в регистр сведений
//
// Параметры:
//   Статус - Строка - Статус документа
//   Документ - ДокументСсылка - Ссылка на документ
//
Процедура СохранитьСтатусДокумента(Статус, Документ) Экспорт
	
	СвДата = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту("ИдентификаторДляФормул", "ДатаПолученияСтатуса");
	СвСтатус = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту("ИдентификаторДляФормул", "СтатусДиадок");
	
	ДопРекиСведПустаяСсылка = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.ПустаяСсылка();
	
	Если СвДата = ДопРекиСведПустаяСсылка ИЛИ СвСтатус = ДопРекиСведПустаяСсылка Тогда
		Возврат;
	КонецЕсли;
	
	ДопСведенияНаборЗаписей = РегистрыСведений.ДополнительныеСведения.СоздатьНаборЗаписей();
	ДопСведенияНаборЗаписей.Отбор.Объект.Установить(Документ);
	ДопСведенияНаборЗаписей.Отбор.Свойство.Установить(СвДата);
	ДопСведенияНаборЗаписей.Прочитать();
	
	Если ДопСведенияНаборЗаписей.Количество() = 0 Тогда
		НовЗапись = ДопСведенияНаборЗаписей.Добавить();
	Иначе
		НовЗапись = ДопСведенияНаборЗаписей[0];
	КонецЕсли;
	
	НовЗапись.Объект = Документ;
	НовЗапись.Свойство = СвДата;
	НовЗапись.Значение = ТекущаяДатаСеанса();
	ДопСведенияНаборЗаписей.Записать(Истина);
	
	ДопСведенияНаборЗаписей = РегистрыСведений.ДополнительныеСведения.СоздатьНаборЗаписей();
	ДопСведенияНаборЗаписей.Отбор.Объект.Установить(Документ);
	ДопСведенияНаборЗаписей.Отбор.Свойство.Установить(СвСтатус);
	ДопСведенияНаборЗаписей.Прочитать();
	
	Если ДопСведенияНаборЗаписей.Количество() = 0 Тогда
		НовЗапись = ДопСведенияНаборЗаписей.Добавить();
	Иначе
		НовЗапись = ДопСведенияНаборЗаписей[0];
	КонецЕсли;
	
	НовЗапись.Объект = Документ;
	НовЗапись.Свойство = СвСтатус;
	НовЗапись.Значение = Статус;
	
	ДопСведенияНаборЗаписей.Записать(Истина);
	
КонецПроцедуры

// Получает статус документа из регистра сведений
//
// Параметры:
//   Документ - ДокументСсылка - Ссылка на документ
//
// Возвращаемое значение:
//   Строка - Статус документа или пустая строка, если статус не найден
//
Функция ПолучитьСтатусДокумента(Документ) Экспорт
	
	СвСтатус = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоРеквизиту("ИдентификаторДляФормул", "СтатусДиадок");
	
	ДопРекиСведПустаяСсылка = ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.ПустаяСсылка();
	
	Если СвСтатус = ДопРекиСведПустаяСсылка Тогда
		Возврат "";
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ДополнительныеСведения.Значение КАК Значение
		|ИЗ
		|	РегистрСведений.ДополнительныеСведения КАК ДополнительныеСведения
		|ГДЕ
		|	ДополнительныеСведения.Объект = &Объект
		|	И ДополнительныеСведения.Свойство = &Свойство";
	
	Запрос.УстановитьПараметр("Объект", Документ);
	Запрос.УстановитьПараметр("Свойство", СвСтатус);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если РезультатЗапроса.Пустой() Тогда
		Возврат "";
	КонецЕсли;
	
	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	
	Возврат Строка(Выборка.Значение);
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Возвращает ключ разработчика Диадок по умолчанию
//
// Возвращаемое значение:
//   Строка - Ключ API разработчика
//
Функция ПолучитьКлючРазработчикаПоУмолчанию()
	
	// Ключ API, предоставленный СКБ Контур для интеграции с Диадок
	Возврат "1C-DDPro-v4-32-1-fd045202-5e14-4b40-80b5-fc756069b76f";
	
КонецФункции

// Получает идентификатор документа из регистра дополнительных сведений
//
// Параметры:
//   Документ - ДокументСсылка - Ссылка на документ
//
// Возвращаемое значение:
//   Строка - Идентификатор документа
//
Функция ПолучитьИдентификаторДокумента(Документ)
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	Значение
	|ИЗ
	|	РегистрСведений.ДополнительныеСведения
	|ГДЕ
	|	Свойство = &ИдентификаторДокументаВДиадок
	|	И Объект = &Объект
	|	И НЕ Значение ПОДОБНО ""усл:%""");
	
	Запрос.УстановитьПараметр("Объект", Документ);
	Запрос.УстановитьПараметр("ИдентификаторДокументаВДиадок", 
		ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоНаименованию("ИдентификаторДокументаВДиадок"));
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		
		Выборка = РезультатЗапроса.Выбрать();
		Выборка.Следующий();
		
		Если ЗначениеЗаполнено(Выборка.Значение) Тогда
			Возврат КонвертироватьЧисло64вГуид(Выборка.Значение);
		КонецЕсли;
		
	КонецЕсли;
	
КонецФункции

// Получает идентификатор документа для ссылки из регистра дополнительных сведений
//
// Параметры:
//   Документ - ДокументСсылка - Ссылка на документ
//
// Возвращаемое значение:
//   Строка - Идентификатор документа для формирования ссылки
//
Функция ПолучитьИдентификаторДокументаДляСсылки(Документ)
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	Значение
	|ИЗ
	|	РегистрСведений.ДополнительныеСведения
	|ГДЕ
	|	Свойство = &ИдентификаторДокументаВДиадок
	|	И Объект = &Объект
	|	И НЕ Значение ПОДОБНО ""усл:%""");
	
	Запрос.УстановитьПараметр("Объект", Документ);
	Запрос.УстановитьПараметр("ИдентификаторДокументаВДиадок", 
		ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоНаименованию("ИдентификаторДокументаВДиадок"));
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		
		Выборка = РезультатЗапроса.Выбрать();
		Выборка.Следующий();
		
		Если ЗначениеЗаполнено(Выборка.Значение) Тогда
			Возврат MRS_ИнтеграцияДиадокКлиентСервер.Base64_2_GUID(Выборка.Значение);
		КонецЕсли;
		
	КонецЕсли;
	
КонецФункции

// Получает идентификатор ящика документа из регистра дополнительных сведений
//
// Параметры:
//   Документ - ДокументСсылка - Ссылка на документ
//
// Возвращаемое значение:
//   Строка - Идентификатор ящика
//
Функция ПолучитьИдентификаторЯщикаДокумента(Документ)
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ
	|	Значение
	|ИЗ
	|	РегистрСведений.ДополнительныеСведения
	|ГДЕ
	|	Свойство = &ИдентификаторДокументаВДиадок
	|	И Объект = &Объект
	|	И НЕ Значение ПОДОБНО ""усл:%""");
	
	Запрос.УстановитьПараметр("Объект", Документ);
	Запрос.УстановитьПараметр("ИдентификаторДокументаВДиадок", 
		ПланыВидовХарактеристик.ДополнительныеРеквизитыИСведения.НайтиПоНаименованию("ИдентификаторЯщикДокументаВДиадок"));
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		
		Выборка = РезультатЗапроса.Выбрать();
		Выборка.Следующий();
		
		Если ЗначениеЗаполнено(Выборка.Значение) Тогда
			Возврат Выборка.Значение;
		КонецЕсли;
		
	КонецЕсли;
	
КонецФункции

// Конвертирует Base64 строку в GUID
//
// Параметры:
//   СтрокаBase64 - Строка - Строка в формате Base64
//
// Возвращаемое значение:
//   Строка - GUID
//
Функция КонвертироватьЧисло64вГуид(СтрокаBase64)
	
	СтрокаHex = Прав(MRS_ИнтеграцияДиадокКлиентСервер.Convert_Binary_to_Hex(
		MRS_ИнтеграцияДиадокКлиентСервер.Convert_Base64_to_Binary(СтрокаBase64)), 64);
	
	Возврат MRS_ИнтеграцияДиадокКлиентСервер.Convert_Hex_to_GUID(СтрокаHex);
	
КонецФункции

// Читает данные из JSON строки
//
// Параметры:
//   ТекстОтвета - Строка - JSON строка
//
// Возвращаемое значение:
//   Произвольный - Десериализованные данные
//
Функция ПрочитатьДанныеJSON(ТекстОтвета)
	
	ЧтениеJSON = Новый ЧтениеJSON;
	ЧтениеJSON.УстановитьСтроку(ТекстОтвета);
	Объект1с = ПрочитатьJSON(ЧтениеJSON);
	ЧтениеJSON.Закрыть();
	
	Возврат Объект1с;
	
КонецФункции

// Возвращает соответствие статусов документов API Диадок
//
// Возвращаемое значение:
//   Соответствие - Соответствие кодов статусов и их текстовых представлений
//
Функция ПолучитьСоответствиеСтатусовДокументов()
	
	Результат = Новый Соответствие;
	
	Результат.Вставить("RevocationAccepted", "Аннулирован");
	Результат.Вставить("Finished", "Документооборот завершен");
	Результат.Вставить("RevocationIsRequestedByMe", "Ожидается аннулирование");
	Результат.Вставить("InvalidSenderSignature", "Ошибка подписи");
	Результат.Вставить("RoamingNotificationError", "Ошибка доставки документа через роуминг");
	Результат.Вставить("WithRecipientSignature", "Подписан контрагентом");
	Результат.Вставить("RequestsMyRevocation", "Требуется аннулирование");
	Результат.Вставить("HaveToCreateReceipt", "Требуется подписать извещение");
	Результат.Вставить("InvoiceAmendmentRequested", "Требуется уточнение");
	Результат.Вставить("RecipientSignatureRequestRejected", "Отказано в подписи контрагенту");
	Результат.Вставить("WaitingForRecipientSignature", "Требуется подпись");
	Результат.Вставить("WaitingForReceipt", "Ожидается извещение о получении");
	Результат.Вставить("WaitingForProxySignature", "Ожидается промежуточная подпись");
	Результат.Вставить("ProxySignatureRejected", "Отказано в промежуточной подписи");
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти

